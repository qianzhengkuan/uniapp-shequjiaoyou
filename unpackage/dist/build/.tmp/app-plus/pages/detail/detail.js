(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/detail"],{"3bcf":function(t,n,o){"use strict";(function(t,e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=u(o("91e3"));function u(t){return t&&t.__esModule?t:{default:t}}var s=function(){Promise.all([o.e("common/vendor"),o.e("components/common/common-list")]).then(function(){return resolve(o("7993"))}.bind(null,o)).catch(o.oe)},r=function(){o.e("components/common/bottom-input").then(function(){return resolve(o("7439"))}.bind(null,o)).catch(o.oe)},c=function(){Promise.all([o.e("common/vendor"),o.e("components/common/more-share")]).then(function(){return resolve(o("6aa9"))}.bind(null,o)).catch(o.oe)},a={components:{commonList:s,bottomInput:r,moreShare:c},data:function(){return{info:{id:0,user_id:0,username:"昵称",userpic:"",newstime:0,isFollow:!1,title:"",titlepic:"",support:{type:"support",support_count:0,unsupport_count:0},comment_count:0,share_num:0,content:""},images:[],comments:[],focus:!1,reply_id:0}},onLoad:function(n){var o=this;n.detail&&this.__init(JSON.parse(n.detail)),t.$on("updateFollowOrSupport",(function(t){switch(t.type){case"follow":o.follow(t.data.user_id);break;case"support":o.doSupport(t.data);break}}))},onUnload:function(){t.$off("updateFollowOrSupport",(function(t){}))},computed:{imagesList:function(){return this.images.map((function(t){return t.url}))}},onNavigationBarButtonTap:function(){this.$refs.share.open({title:this.info.title,shareText:this.info.title,href:"http://www.dishaxy.com",image:this.info.titlepic})},onBackPress:function(){this.$refs.share.close()},methods:{__init:function(n){var o=this;t.setNavigationBarTitle({title:n.title}),this.info=n,this.info.content="",this.$H.get("/post/"+this.info.id).then((function(t){o.info.content=t.detail.content,o.images=t.detail.images,e("log",t," at pages\\detail\\detail.vue:148")})),this.getComments()},doComment:function(){},doShare:function(){},follow:function(){this.info.isFollow=!0,t.showToast({title:"关注成功"})},doSupport:function(n){if(this.info.support.type===n.type)return t.showToast({title:"你已经操作过了",icon:"none"});var o="support"===n.type?"顶":"踩";""===this.info.support.type?this.info.support[n.type+"_count"]++:"support"===this.info.support.type&&"unsupport"===n.type?(this.info.support.support_count--,this.info.support.unsupport_count++):"unsupport"===this.info.support.type&&"support"===n.type&&(this.info.support.support_count++,this.info.support.unsupport_count--),this.info.support.type=n.type,t.showToast({title:o})},preview:function(n){t.previewImage({current:n,urls:this.imagesList})},submit:function(n){var o=this;if(""===n)return t.showToast({title:"评论不能为空",icon:"none"});t.showLoading({title:"评论中...",mask:!1}),this.$H.post("/post/comment",{fid:this.reply_id,data:n,post_id:this.info.id},{token:!0}).then((function(n){t.hideLoading(),o.getComments()})).catch((function(n){t.hideLoading()}))},getComments:function(){var n=this;this.$H.get("/post/"+this.info.id+"/comment").then((function(o){n.comments=n.__ArrSort(o.list),n.info.comment_count=n.comments.length,t.$emit("updateCommentsCount",{id:n.info.id,count:n.info.comment_count})}))},__ArrSort:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=[],e=0,u=function t(n,e,u){for(var s=0;s<n.length;s++){var r=n[s];r.fid==e&&(r.lev=u,o.push({id:r.id,fid:r.fid,userid:r.user.id,userpic:r.user.userpic,username:r.user.username,time:i.default.gettime(r.create_time),data:r.data}),t(n,r.id,u+1))}};return u(t,n,e),o},reply:function(t){this.reply_id=t,this.focus=!0},blur:function(){this.reply_id=0,this.focus=!1}}};n.default=a}).call(this,o("6e42")["default"],o("0de9")["default"])},"7dad":function(t,n,o){"use strict";o.r(n);var e=o("8904"),i=o("93cd");for(var u in i)"default"!==u&&function(t){o.d(n,t,(function(){return i[t]}))}(u);var s,r=o("f0c5"),c=Object(r["a"])(i["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],s);n["default"]=c.exports},8904:function(t,n,o){"use strict";var e,i=function(){var t=this,n=t.$createElement;t._self._c},u=[];o.d(n,"b",(function(){return i})),o.d(n,"c",(function(){return u})),o.d(n,"a",(function(){return e}))},"93cd":function(t,n,o){"use strict";o.r(n);var e=o("3bcf"),i=o.n(e);for(var u in e)"default"!==u&&function(t){o.d(n,t,(function(){return e[t]}))}(u);n["default"]=i.a},bc9f:function(t,n,o){"use strict";(function(t){o("d1f3"),o("921b");e(o("66fd"));var n=e(o("7dad"));function e(t){return t&&t.__esModule?t:{default:t}}t(n.default)}).call(this,o("6e42")["createPage"])}},[["bc9f","common/runtime","common/vendor"]]]);